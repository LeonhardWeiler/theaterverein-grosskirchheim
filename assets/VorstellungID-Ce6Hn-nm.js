import{r as u,j as r,u as f,a as h}from"./index-Dy-Qk1Hv.js";import{v as g}from"./vorstellungen-3f_-0A42.js";function b(t,e){const s=`/assets/images/${t}/images/`;return{id:e,big:`${s}${e}-big.webp`,medium:`${s}${e}-medium.webp`,small:`${s}${e}-small.webp`}}function x(t){return Array.from({length:t},(e,s)=>String(s+1).padStart(4,"0"))}function v(t,e){return x(e).map(n=>b(t,n))}function j(t,e,s){const[n,c]=u.useState([]),l=u.useRef(new Set);return u.useEffect(()=>{const i=v(t,e),a=Array.isArray(i)?i.filter(o=>o&&o.big):[];c(a)},[t,e]),u.useEffect(()=>{if(!n.length||s>=n.length)return;const i=5;for(let a=1;a<=i;a++){const o=s+a;if(o>=n.length)break;const d=n[o];if(!(!d||!d.big)&&!l.current.has(d.big)){const m=new Image;m.src=d.big,l.current.add(d.big)}}},[s,n]),n}function p(t,e){const[s,n]=u.useState(0),c=u.useCallback(()=>{n(i=>Math.max(i-1,0))},[]),l=u.useCallback(()=>{n(i=>Math.min(i+1,e-1))},[e]);return u.useEffect(()=>{const i=localStorage.getItem(`carousel-${t}-index`);i&&n(Number(i)||0)},[t]),u.useEffect(()=>{e&&localStorage.setItem(`carousel-${t}-index`,Math.min(s,e-1))},[s,e,t]),u.useEffect(()=>{s>=e&&e&&n(0)},[s,e]),{currentIndex:s,setCurrentIndex:n,prevImage:c,nextImage:l}}function k({prev:t,next:e,closeZoom:s}){u.useEffect(()=>{const n=c=>{c.key==="ArrowLeft"&&t(),c.key==="ArrowRight"&&e(),c.key==="Escape"&&s()};return document.addEventListener("keydown",n),()=>document.removeEventListener("keydown",n)},[t,e,s])}function C({img:t,onClick:e}){return!t||!t.big?r.jsx("p",{children:"Kein Bild verfügbar"}):r.jsx("img",{src:t.big,srcSet:t.medium&&t.big?`${t.medium} 700w, ${t.big} 1200w`:void 0,alt:"Bild",loading:"eager",fetchPriority:"high",className:"carousel-image",onClick:e})}function N({showPrev:t,showNext:e,onPrev:s,onNext:n,zoom:c=!1}){return r.jsxs(r.Fragment,{children:[t&&r.jsx("button",{className:`carousel-btn ${c?"zoom-btn":""} left`,onClick:s,children:"‹"}),e&&r.jsx("button",{className:`carousel-btn ${c?"zoom-btn":""} right`,onClick:n,children:"›"})]})}function w({images:t,currentIndex:e,onSelect:s}){const[n,c]=u.useState({}),l=u.useRef([]);return u.useEffect(()=>{const i=new IntersectionObserver(a=>{a.forEach(o=>{if(o.isIntersecting){const d=o.target.dataset.index;c(m=>({...m,[d]:!0})),i.unobserve(o.target)}})},{rootMargin:"200px"});return l.current.forEach(a=>a&&i.observe(a)),()=>i.disconnect()},[t]),r.jsx("div",{className:"carousel-thumbnails",children:t.map((i,a)=>r.jsx("img",{ref:o=>l.current[a]=o,"data-index":a,src:n[a]?i.small:null,alt:"thumbnail",className:`carousel-thumb ${a===e?"active":""}`,onClick:()=>s(a)},a))})}function I({children:t,onSwipeLeft:e,onSwipeRight:s}){const n=u.useRef(null),c=u.useRef(null),l=o=>{n.current=o.changedTouches[0].screenX},i=o=>{c.current=o.changedTouches[0].screenX,a()},a=()=>{const o=n.current-c.current;Math.abs(o)<40||(o>0?e():s())};return r.jsx("div",{onTouchStart:l,onTouchEnd:i,children:t})}function E({img:t,onClose:e,prevImage:s,nextImage:n,hasPrev:c,hasNext:l,onTouchStart:i,onTouchEnd:a}){return r.jsxs("div",{className:"carousel-container",onTouchStart:i,onTouchEnd:a,children:[r.jsxs("div",{className:"zoom-overlay",onClick:e,children:[r.jsx("img",{src:t.big,alt:"Zoom",className:"zoom-image",onClick:o=>o.stopPropagation()}),r.jsx("button",{className:"zoom-close",onClick:e,children:"×"})]}),c&&r.jsx("button",{className:"carousel-btn zoom-btn left",onClick:s,children:"‹"}),l&&r.jsx("button",{className:"carousel-btn zoom-btn right",onClick:n,children:"›"})]})}function S({folder:t,imageCount:e}){const[s,n]=u.useState(!1),c=j(t,e),{currentIndex:l,setCurrentIndex:i,prevImage:a,nextImage:o}=p(t,c.length);if(k({prev:a,next:o,closeZoom:()=>n(!1)}),!c.length)return r.jsx("p",{children:"Keine Bilder gefunden"});const d=c[l];return r.jsxs(r.Fragment,{children:[r.jsx(I,{onSwipeLeft:o,onSwipeRight:a,children:r.jsxs("div",{className:"carousel-container",children:[r.jsx(C,{img:d,onClick:()=>n(!0)}),r.jsx(N,{showPrev:l>0,showNext:l<c.length-1,onPrev:a,onNext:o})]})}),r.jsx(w,{images:c,currentIndex:l,onSelect:i}),s&&r.jsx(E,{img:d,onClose:()=>n(!1),prevImage:a,nextImage:o,hasPrev:l>0,hasNext:l<c.length-1})]})}function z(){const{id:t}=f(),e=g[t],s=h();if(!e)return r.jsx("p",{children:"Lade..."});const n=()=>{s(-1)};return r.jsxs("div",{className:"vorstellung-detail",children:[r.jsx("button",{onClick:n,className:"back-link",children:"< Zurück zu Vorstellungen"}),r.jsx("h1",{children:e.title}),r.jsx("p",{children:e.year}),r.jsx(S,{folder:e["media-folder"],imageCount:e["image-count"]}),r.jsx("div",{className:"item-text",children:e.content})]})}export{z as default};
