import{r as u,j as a,u as g,a as h}from"./index-BMcLjYyD.js";import{v as b}from"./vorstellungen-3f_-0A42.js";function x(n,e){const s=`/assets/images/${n}/images/`;return{id:e,big:`${s}${e}-big.webp`,medium:`${s}${e}-medium.webp`,small:`${s}${e}-small.webp`}}function v(n){return Array.from({length:n},(e,s)=>String(s+1).padStart(4,"0"))}function j(n,e){return v(e).map(t=>x(n,t))}function p(n,e,s){const[t,o]=u.useState([]),l=u.useRef(new Set);return u.useEffect(()=>{const i=j(n,e),c=Array.isArray(i)?i.filter(r=>r&&r.big):[];o(c)},[n,e]),u.useEffect(()=>{if(!t.length||s>=t.length)return;const i=5;for(let c=1;c<=i;c++){const r=s+c;if(r>=t.length)break;const d=t[r];if(!(!d||!d.big)&&!l.current.has(d.big)){const m=new Image;m.src=d.big,l.current.add(d.big)}}},[s,t]),t}function k(n,e){const[s,t]=u.useState(0),o=u.useCallback(()=>{t(i=>Math.max(i-1,0))},[]),l=u.useCallback(()=>{t(i=>Math.min(i+1,e-1))},[e]);return u.useEffect(()=>{const i=localStorage.getItem(`carousel-${n}-index`);i&&t(Number(i)||0)},[n]),u.useEffect(()=>{e&&localStorage.setItem(`carousel-${n}-index`,Math.min(s,e-1))},[s,e,n]),u.useEffect(()=>{s>=e&&e&&t(0)},[s,e]),{currentIndex:s,setCurrentIndex:t,prevImage:o,nextImage:l}}function C({prev:n,next:e,closeZoom:s}){u.useEffect(()=>{const t=o=>{o.key==="ArrowLeft"&&n(),o.key==="ArrowRight"&&e(),o.key==="Escape"&&s()};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[n,e,s])}function I({img:n,onClick:e}){if(!n||!n.big)return a.jsx("p",{children:"Kein Bild verfügbar"});const s=u.useRef(null);function t(){s.current?.classList.remove("loading")}return a.jsx("img",{ref:s,src:n.big,srcSet:n.medium&&n.big?`${n.medium} 700w, ${n.big} 1200w`:void 0,alt:"Erstes Bild des Bilder Karussells",loading:"eager",fetchPriority:"high",className:"carousel-image",onClick:e,onLoad:t})}function N({showPrev:n,showNext:e,onPrev:s,onNext:t,zoom:o=!1}){return a.jsxs(a.Fragment,{children:[n&&a.jsx("button",{className:`carousel-btn ${o?"zoom-btn":""} left`,onClick:s,children:"‹"}),e&&a.jsx("button",{className:`carousel-btn ${o?"zoom-btn":""} right`,onClick:t,children:"›"})]})}function w({images:n,currentIndex:e,onSelect:s}){const[t,o]=u.useState({}),l=u.useRef([]);function i(c){document.querySelector(".carousel-image")?.classList.add("loading"),s(c)}return u.useEffect(()=>{const c=new IntersectionObserver(r=>{r.forEach(d=>{if(d.isIntersecting){const m=d.target.dataset.index;o(f=>({...f,[m]:!0})),c.unobserve(d.target)}})},{rootMargin:"200px"});return l.current.forEach(r=>r&&c.observe(r)),()=>c.disconnect()},[n]),a.jsx("div",{tabIndex:"-1",className:"carousel-thumbnails",children:n.map((c,r)=>a.jsx("img",{ref:d=>l.current[r]=d,"data-index":r,src:t[r]?c.small:null,alt:"kleines Vorschaubild für das Karussell",className:`carousel-thumb ${r===e?"active":""}`,onClick:()=>i(r)},r))})}function E({children:n,onSwipeLeft:e,onSwipeRight:s}){const t=u.useRef(null),o=u.useRef(null),l=r=>{t.current=r.changedTouches[0].screenX},i=r=>{o.current=r.changedTouches[0].screenX,c()},c=()=>{const r=t.current-o.current;Math.abs(r)<40||(r>0?e():s())};return a.jsx("div",{onTouchStart:l,onTouchEnd:i,children:n})}function S({img:n,onClose:e,prevImage:s,nextImage:t,hasPrev:o,hasNext:l,onTouchStart:i,onTouchEnd:c}){return a.jsxs("div",{className:"carousel-container",onTouchStart:i,onTouchEnd:c,children:[a.jsxs("div",{className:"zoom-overlay",onClick:e,children:[a.jsx("img",{src:n.big,alt:"Vergrößertes Bild im Zoom-Modus",className:"zoom-image",onClick:r=>r.stopPropagation()}),a.jsx("button",{className:"zoom-close",onClick:e,children:"×"})]}),o&&a.jsx("button",{className:"carousel-btn zoom-btn left",onClick:s,children:"‹"}),l&&a.jsx("button",{className:"carousel-btn zoom-btn right",onClick:t,children:"›"})]})}function $({folder:n,imageCount:e}){const[s,t]=u.useState(!1),o=p(n,e),{currentIndex:l,setCurrentIndex:i,prevImage:c,nextImage:r}=k(n,o.length);if(C({prev:c,next:r,closeZoom:()=>t(!1)}),!o.length)return a.jsx("p",{children:"Keine Bilder gefunden"});const d=o[l];return a.jsxs(a.Fragment,{children:[a.jsx(E,{onSwipeLeft:r,onSwipeRight:c,children:a.jsxs("div",{className:"carousel-container",children:[a.jsx(I,{img:d,onClick:()=>t(!0)}),a.jsx(N,{showPrev:l>0,showNext:l<o.length-1,onPrev:c,onNext:r})]})}),a.jsx(w,{images:o,currentIndex:l,onSelect:i}),s&&a.jsx(S,{img:d,onClose:()=>t(!1),prevImage:c,nextImage:r,hasPrev:l>0,hasNext:l<o.length-1})]})}function M(){const{id:n}=g(),e=b[n],s=h();if(!e)return a.jsx("p",{children:"Lade..."});const t=()=>{s(-1)};return a.jsxs("div",{className:"vorstellung-detail",children:[a.jsx("button",{onClick:t,className:"back-link",children:"< Zurück zu Vorstellungen"}),a.jsx("h1",{children:e.title}),a.jsx("p",{children:e.year}),a.jsx($,{folder:e["media-folder"],imageCount:e["image-count"]}),a.jsx("div",{className:"item-text",children:e.content})]})}export{M as default};
