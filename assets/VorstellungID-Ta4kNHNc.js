import{r as u,j as o,u as h,a as g}from"./index-CjF1s8tY.js";import{v as b}from"./vorstellungen-3f_-0A42.js";function x(n,e){const t=`/assets/images/${n}/images/`;return{id:e,big:`${t}${e}-big.webp`,medium:`${t}${e}-medium.webp`,small:`${t}${e}-small.webp`}}function v(n){return Array.from({length:n},(e,t)=>String(t+1).padStart(4,"0"))}function j(n,e){return v(e).map(s=>x(n,s))}function k(n,e,t){const[s,l]=u.useState([]),d=u.useRef(new Set);return u.useEffect(()=>{const i=j(n,e),a=Array.isArray(i)?i.filter(r=>r&&r.big):[];l(a)},[n,e]),u.useEffect(()=>{if(!s.length||t>=s.length)return;const i=5;for(let a=1;a<=i;a++){const r=t+a;if(r>=s.length)break;const c=s[r];if(!(!c||!c.big)&&!d.current.has(c.big)){const f=new Image;f.src=c.big,d.current.add(c.big)}}},[t,s]),s}function p(n,e,t,s){const[l,d]=u.useState(0),i=u.useCallback(c=>{d(f=>{const m=typeof c=="function"?c(f):c;return m===f||m<0||m>=e||e===0?f:(t?.current?.classList.add("loading"),s?.current?.classList.add("loading"),m)})},[e,t,s]),a=u.useCallback(()=>{i(c=>Math.max(c-1,0))},[i]),r=u.useCallback(()=>{i(c=>Math.min(c+1,e-1))},[i,e]);return u.useEffect(()=>{const c=localStorage.getItem(`carousel-${n}-index`);c!==null&&i(Number(c)||0)},[n,i]),u.useEffect(()=>{e&&localStorage.setItem(`carousel-${n}-index`,Math.min(l,e-1))},[l,e,n]),u.useEffect(()=>{l>=e&&e&&i(0)},[l,e,i]),{currentIndex:l,setCurrentIndex:i,prevImage:a,nextImage:r}}function C({prev:n,next:e,closeZoom:t}){u.useEffect(()=>{const s=l=>{l.key==="ArrowLeft"&&n(),l.key==="ArrowRight"&&e(),l.key==="Escape"&&t()};return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[n,e,t])}function N({img:n,onClick:e,imageRef:t}){if(!n||!n.big)return o.jsx("p",{children:"Kein Bild verfügbar"});function s(){t?.current?.classList.remove("loading")}return o.jsx("img",{ref:t,src:n.big,srcSet:n.medium&&n.big?`${n.medium} 700w, ${n.big} 1200w`:void 0,alt:"Erstes Bild des Bilder Karussells",loading:"eager",fetchPriority:"high",className:"carousel-image",onClick:e,onLoad:s})}function I({showPrev:n,showNext:e,onPrev:t,onNext:s,zoom:l=!1}){return o.jsxs(o.Fragment,{children:[n&&o.jsx("button",{className:`carousel-btn ${l?"zoom-btn":""} left`,onClick:t,children:"‹"}),e&&o.jsx("button",{className:`carousel-btn ${l?"zoom-btn":""} right`,onClick:s,children:"›"})]})}function w({images:n,currentIndex:e,onSelect:t}){const[s,l]=u.useState({}),d=u.useRef([]);function i(a){a!==e&&t(a)}return u.useEffect(()=>{const a=new IntersectionObserver(r=>{r.forEach(c=>{if(c.isIntersecting){const f=c.target.dataset.index;l(m=>({...m,[f]:!0})),a.unobserve(c.target)}})},{rootMargin:"200px"});return d.current.forEach(r=>r&&a.observe(r)),()=>a.disconnect()},[n]),u.useEffect(()=>{const a=d.current[e];a&&a.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},[e]),o.jsx("div",{tabIndex:"-1",className:"carousel-thumbnails",children:n.map((a,r)=>o.jsx("img",{ref:c=>d.current[r]=c,"data-index":r,src:s[r]?a.small:void 0,alt:"kleines Vorschaubild für das Karussell",className:`carousel-thumb ${r===e?"active":""}`,onClick:()=>i(r),loading:"lazy"},r))})}function E({children:n,onSwipeLeft:e,onSwipeRight:t}){const s=u.useRef(null),l=u.useRef(null),d=r=>{s.current=r.changedTouches[0].screenX},i=r=>{l.current=r.changedTouches[0].screenX,a()},a=()=>{const r=s.current-l.current;Math.abs(r)<40||(r>0?e():t())};return o.jsx("div",{onTouchStart:d,onTouchEnd:i,children:n})}function S({img:n,onClose:e,prevImage:t,nextImage:s,hasPrev:l,hasNext:d,onTouchStart:i,onTouchEnd:a,imageRef:r}){function c(){r?.current?.classList.remove("loading")}return o.jsxs("div",{className:"carousel-container",onTouchStart:i,onTouchEnd:a,children:[o.jsxs("div",{className:"zoom-overlay",onClick:e,children:[o.jsx("img",{ref:r,src:n.big,alt:"Vergrößertes Bild im Zoom-Modus",className:"zoom-image",onClick:f=>f.stopPropagation(),onLoad:c}),o.jsx("button",{className:"zoom-close",onClick:e,children:"×"})]}),l&&o.jsx("button",{className:"carousel-btn zoom-btn left",onClick:t,children:"‹"}),d&&o.jsx("button",{className:"carousel-btn zoom-btn right",onClick:s,children:"›"})]})}function $({folder:n,imageCount:e}){const[t,s]=u.useState(!1),l=u.useRef(null),d=u.useRef(null),i=k(n,e),{currentIndex:a,setCurrentIndex:r,prevImage:c,nextImage:f}=p(n,i.length,l,d);if(C({prev:c,next:f,closeZoom:()=>s(!1)}),!i.length)return o.jsx("p",{children:"Keine Bilder gefunden"});const m=i[a];return o.jsxs(o.Fragment,{children:[o.jsx(E,{onSwipeLeft:f,onSwipeRight:c,children:o.jsxs("div",{className:"carousel-container",children:[o.jsx(N,{img:m,onClick:()=>s(!0),imageRef:l}),o.jsx(I,{showPrev:a>0,showNext:a<i.length-1,onPrev:c,onNext:f})]})}),o.jsx(w,{images:i,currentIndex:a,onSelect:r}),t&&o.jsx(S,{img:m,onClose:()=>s(!1),prevImage:c,nextImage:f,hasPrev:a>0,hasNext:a<i.length-1,imageRef:d})]})}function z(){const{id:n}=h(),e=b[n],t=g();if(!e)return o.jsx("p",{children:"Lade..."});const s=()=>{t(-1)};return o.jsxs("div",{className:"vorstellung-detail",children:[o.jsx("button",{onClick:s,className:"back-link",children:"< Zurück zu Vorstellungen"}),o.jsx("h1",{children:e.title}),o.jsx("p",{children:e.year}),o.jsx($,{folder:e["media-folder"],imageCount:e["image-count"]}),o.jsx("div",{className:"item-text",children:e.content})]})}export{z as default};
