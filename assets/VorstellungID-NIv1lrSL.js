import{r as u,j as a,u as h,a as g}from"./index-D7tOGrz0.js";import{v as b}from"./vorstellungen-3f_-0A42.js";function x(n,e){const t=`/assets/images/${n}/images/`;return{id:e,big:`${t}${e}-big.webp`,medium:`${t}${e}-medium.webp`,small:`${t}${e}-small.webp`}}function v(n){return Array.from({length:n},(e,t)=>String(t+1).padStart(4,"0"))}function j(n,e){return v(e).map(s=>x(n,s))}function p(n,e,t){const[s,l]=u.useState([]),d=u.useRef(new Set);return u.useEffect(()=>{const i=j(n,e),o=Array.isArray(i)?i.filter(r=>r&&r.big):[];l(o)},[n,e]),u.useEffect(()=>{if(!s.length||t>=s.length)return;const i=5;for(let o=1;o<=i;o++){const r=t+o;if(r>=s.length)break;const c=s[r];if(!(!c||!c.big)&&!d.current.has(c.big)){const f=new Image;f.src=c.big,d.current.add(c.big)}}},[t,s]),s}function k(n,e,t,s){const[l,d]=u.useState(0),i=u.useCallback(c=>{t?.current&&t.current.classList.add("loading"),s?.current&&s.current.classList.add("loading"),d(f=>typeof c=="function"?c(f):c)},[t,s]),o=u.useCallback(()=>{i(c=>Math.max(c-1,0))},[i]),r=u.useCallback(()=>{i(c=>Math.min(c+1,e-1))},[i,e]);return u.useEffect(()=>{const c=localStorage.getItem(`carousel-${n}-index`);c!==null&&i(Number(c)||0)},[n,i]),u.useEffect(()=>{e&&localStorage.setItem(`carousel-${n}-index`,Math.min(l,e-1))},[l,e,n]),u.useEffect(()=>{l>=e&&e&&i(0)},[l,e,i]),{currentIndex:l,setCurrentIndex:i,prevImage:o,nextImage:r}}function C({prev:n,next:e,closeZoom:t}){u.useEffect(()=>{const s=l=>{l.key==="ArrowLeft"&&n(),l.key==="ArrowRight"&&e(),l.key==="Escape"&&t()};return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[n,e,t])}function N({img:n,onClick:e,imageRef:t}){if(!n||!n.big)return a.jsx("p",{children:"Kein Bild verfügbar"});function s(){t?.current?.classList.remove("loading")}return a.jsx("img",{ref:t,src:n.big,srcSet:n.medium&&n.big?`${n.medium} 700w, ${n.big} 1200w`:void 0,alt:"Erstes Bild des Bilder Karussells",loading:"eager",fetchPriority:"high",className:"carousel-image",onClick:e,onLoad:s})}function w({showPrev:n,showNext:e,onPrev:t,onNext:s,zoom:l=!1}){return a.jsxs(a.Fragment,{children:[n&&a.jsx("button",{className:`carousel-btn ${l?"zoom-btn":""} left`,onClick:t,children:"‹"}),e&&a.jsx("button",{className:`carousel-btn ${l?"zoom-btn":""} right`,onClick:s,children:"›"})]})}function E({images:n,currentIndex:e,onSelect:t}){const[s,l]=u.useState({}),d=u.useRef([]);function i(o){o!==e&&t(o)}return u.useEffect(()=>{const o=new IntersectionObserver(r=>{r.forEach(c=>{if(c.isIntersecting){const f=c.target.dataset.index;l(m=>({...m,[f]:!0})),o.unobserve(c.target)}})},{rootMargin:"200px"});return d.current.forEach(r=>r&&o.observe(r)),()=>o.disconnect()},[n]),u.useEffect(()=>{const o=d.current[e];o&&o.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},[e]),a.jsx("div",{tabIndex:"-1",className:"carousel-thumbnails",children:n.map((o,r)=>a.jsx("img",{ref:c=>d.current[r]=c,"data-index":r,src:s[r]?o.small:void 0,alt:"kleines Vorschaubild für das Karussell",className:`carousel-thumb ${r===e?"active":""}`,onClick:()=>i(r),loading:"lazy"},r))})}function I({children:n,onSwipeLeft:e,onSwipeRight:t}){const s=u.useRef(null),l=u.useRef(null),d=r=>{s.current=r.changedTouches[0].screenX},i=r=>{l.current=r.changedTouches[0].screenX,o()},o=()=>{const r=s.current-l.current;Math.abs(r)<40||(r>0?e():t())};return a.jsx("div",{onTouchStart:d,onTouchEnd:i,children:n})}function S({img:n,onClose:e,prevImage:t,nextImage:s,hasPrev:l,hasNext:d,onTouchStart:i,onTouchEnd:o,imageRef:r}){function c(){r?.current?.classList.remove("loading")}return a.jsxs("div",{className:"carousel-container",onTouchStart:i,onTouchEnd:o,children:[a.jsxs("div",{className:"zoom-overlay",onClick:e,children:[a.jsx("img",{ref:r,src:n.big,alt:"Vergrößertes Bild im Zoom-Modus",className:"zoom-image",onClick:f=>f.stopPropagation(),onLoad:c}),a.jsx("button",{className:"zoom-close",onClick:e,children:"×"})]}),l&&a.jsx("button",{className:"carousel-btn zoom-btn left",onClick:t,children:"‹"}),d&&a.jsx("button",{className:"carousel-btn zoom-btn right",onClick:s,children:"›"})]})}function $({folder:n,imageCount:e}){const[t,s]=u.useState(!1),l=u.useRef(null),d=u.useRef(null),i=p(n,e),{currentIndex:o,setCurrentIndex:r,prevImage:c,nextImage:f}=k(n,i.length,l,d);if(C({prev:c,next:f,closeZoom:()=>s(!1)}),!i.length)return a.jsx("p",{children:"Keine Bilder gefunden"});const m=i[o];return a.jsxs(a.Fragment,{children:[a.jsx(I,{onSwipeLeft:f,onSwipeRight:c,children:a.jsxs("div",{className:"carousel-container",children:[a.jsx(N,{img:m,onClick:()=>s(!0),imageRef:l}),a.jsx(w,{showPrev:o>0,showNext:o<i.length-1,onPrev:c,onNext:f})]})}),a.jsx(E,{images:i,currentIndex:o,onSelect:r}),t&&a.jsx(S,{img:m,onClose:()=>s(!1),prevImage:c,nextImage:f,hasPrev:o>0,hasNext:o<i.length-1,imageRef:d})]})}function z(){const{id:n}=h(),e=b[n],t=g();if(!e)return a.jsx("p",{children:"Lade..."});const s=()=>{t(-1)};return a.jsxs("div",{className:"vorstellung-detail",children:[a.jsx("button",{onClick:s,className:"back-link",children:"< Zurück zu Vorstellungen"}),a.jsx("h1",{children:e.title}),a.jsx("p",{children:e.year}),a.jsx($,{folder:e["media-folder"],imageCount:e["image-count"]}),a.jsx("div",{className:"item-text",children:e.content})]})}export{z as default};
