import{r as u,j as a,u as g,a as h}from"./index-BR0LXzWO.js";import{v as b}from"./vorstellungen-3f_-0A42.js";function x(n,e){const t=`/assets/images/${n}/images/`;return{id:e,big:`${t}${e}-big.webp`,medium:`${t}${e}-medium.webp`,small:`${t}${e}-small.webp`}}function v(n){return Array.from({length:n},(e,t)=>String(t+1).padStart(4,"0"))}function j(n,e){return v(e).map(s=>x(n,s))}function p(n,e,t){const[s,c]=u.useState([]),i=u.useRef(new Set);return u.useEffect(()=>{const l=j(n,e),o=Array.isArray(l)?l.filter(r=>r&&r.big):[];c(o)},[n,e]),u.useEffect(()=>{if(!s.length||t>=s.length)return;const l=5;for(let o=1;o<=l;o++){const r=t+o;if(r>=s.length)break;const d=s[r];if(!(!d||!d.big)&&!i.current.has(d.big)){const m=new Image;m.src=d.big,i.current.add(d.big)}}},[t,s]),s}function k(n,e){const[t,s]=u.useState(0),c=u.useCallback(()=>{s(l=>Math.max(l-1,0))},[]),i=u.useCallback(()=>{s(l=>Math.min(l+1,e-1))},[e]);return u.useEffect(()=>{const l=localStorage.getItem(`carousel-${n}-index`);l&&s(Number(l)||0)},[n]),u.useEffect(()=>{e&&localStorage.setItem(`carousel-${n}-index`,Math.min(t,e-1))},[t,e,n]),u.useEffect(()=>{t>=e&&e&&s(0)},[t,e]),{currentIndex:t,setCurrentIndex:s,prevImage:c,nextImage:i}}function C({prev:n,next:e,closeZoom:t}){u.useEffect(()=>{const s=c=>{c.key==="ArrowLeft"&&n(),c.key==="ArrowRight"&&e(),c.key==="Escape"&&t()};return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[n,e,t])}function N({img:n,onClick:e}){if(!n||!n.big)return a.jsx("p",{children:"Kein Bild verfügbar"});const t=u.useRef(null);function s(){t.current?.classList.remove("loading")}return a.jsx("img",{ref:t,src:n.big,srcSet:n.medium&&n.big?`${n.medium} 700w, ${n.big} 1200w`:void 0,alt:"Erstes Bild des Bilder Karussells",loading:"eager",fetchPriority:"high",className:"carousel-image",onClick:e,onLoad:s})}function w({showPrev:n,showNext:e,onPrev:t,onNext:s,zoom:c=!1}){return a.jsxs(a.Fragment,{children:[n&&a.jsx("button",{className:`carousel-btn ${c?"zoom-btn":""} left`,onClick:t,children:"‹"}),e&&a.jsx("button",{className:`carousel-btn ${c?"zoom-btn":""} right`,onClick:s,children:"›"})]})}function I({images:n,currentIndex:e,onSelect:t}){const[s,c]=u.useState({}),i=u.useRef([]);function l(o){if(o===e)return;document.querySelector(".carousel-image")?.classList.add("loading"),t(o)}return u.useEffect(()=>{const o=new IntersectionObserver(r=>{r.forEach(d=>{if(d.isIntersecting){const m=d.target.dataset.index;c(f=>({...f,[m]:!0})),o.unobserve(d.target)}})},{rootMargin:"200px"});return i.current.forEach(r=>r&&o.observe(r)),()=>o.disconnect()},[n]),u.useEffect(()=>{const o=i.current[e];o&&o.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},[e]),a.jsx("div",{tabIndex:"-1",className:"carousel-thumbnails",children:n.map((o,r)=>a.jsx("img",{ref:d=>i.current[r]=d,"data-index":r,src:s[r]?o.small:null,alt:"kleines Vorschaubild für das Karussell",className:`carousel-thumb ${r===e?"active":""}`,onClick:()=>l(r)},r))})}function E({children:n,onSwipeLeft:e,onSwipeRight:t}){const s=u.useRef(null),c=u.useRef(null),i=r=>{s.current=r.changedTouches[0].screenX},l=r=>{c.current=r.changedTouches[0].screenX,o()},o=()=>{const r=s.current-c.current;Math.abs(r)<40||(r>0?e():t())};return a.jsx("div",{onTouchStart:i,onTouchEnd:l,children:n})}function S({img:n,onClose:e,prevImage:t,nextImage:s,hasPrev:c,hasNext:i,onTouchStart:l,onTouchEnd:o}){return a.jsxs("div",{className:"carousel-container",onTouchStart:l,onTouchEnd:o,children:[a.jsxs("div",{className:"zoom-overlay",onClick:e,children:[a.jsx("img",{src:n.big,alt:"Vergrößertes Bild im Zoom-Modus",className:"zoom-image",onClick:r=>r.stopPropagation()}),a.jsx("button",{className:"zoom-close",onClick:e,children:"×"})]}),c&&a.jsx("button",{className:"carousel-btn zoom-btn left",onClick:t,children:"‹"}),i&&a.jsx("button",{className:"carousel-btn zoom-btn right",onClick:s,children:"›"})]})}function $({folder:n,imageCount:e}){const[t,s]=u.useState(!1),c=p(n,e),{currentIndex:i,setCurrentIndex:l,prevImage:o,nextImage:r}=k(n,c.length);if(C({prev:o,next:r,closeZoom:()=>s(!1)}),!c.length)return a.jsx("p",{children:"Keine Bilder gefunden"});const d=c[i];return a.jsxs(a.Fragment,{children:[a.jsx(E,{onSwipeLeft:r,onSwipeRight:o,children:a.jsxs("div",{className:"carousel-container",children:[a.jsx(N,{img:d,onClick:()=>s(!0)}),a.jsx(w,{showPrev:i>0,showNext:i<c.length-1,onPrev:o,onNext:r})]})}),a.jsx(I,{images:c,currentIndex:i,onSelect:l}),t&&a.jsx(S,{img:d,onClose:()=>s(!1),prevImage:o,nextImage:r,hasPrev:i>0,hasNext:i<c.length-1})]})}function M(){const{id:n}=g(),e=b[n],t=h();if(!e)return a.jsx("p",{children:"Lade..."});const s=()=>{t(-1)};return a.jsxs("div",{className:"vorstellung-detail",children:[a.jsx("button",{onClick:s,className:"back-link",children:"< Zurück zu Vorstellungen"}),a.jsx("h1",{children:e.title}),a.jsx("p",{children:e.year}),a.jsx($,{folder:e["media-folder"],imageCount:e["image-count"]}),a.jsx("div",{className:"item-text",children:e.content})]})}export{M as default};
